(()=>{var e={548:(e,t,n)=>{var r=function(){return this}()||Function("return this")(),a=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,o=a&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,e.exports=n(544),a)r.regeneratorRuntime=o;else try{delete r.regeneratorRuntime}catch(e){r.regeneratorRuntime=void 0}},544:e=>{!function(t){"use strict";var n,r=Object.prototype,a=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag",s=t.regeneratorRuntime;if(s)e.exports=s;else{(s=t.regeneratorRuntime=e.exports).wrap=g;var l="suspendedStart",h="suspendedYield",p="executing",f="completed",m={},d={};d[i]=function(){return this};var v=Object.getPrototypeOf,w=v&&v(v(P([])));w&&w!==r&&a.call(w,i)&&(d=w);var y=R.prototype=E.prototype=Object.create(d);k.prototype=y.constructor=R,R.constructor=k,R[u]=k.displayName="GeneratorFunction",s.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===k||"GeneratorFunction"===(t.displayName||t.name))},s.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,R):(e.__proto__=R,u in e||(e[u]="GeneratorFunction")),e.prototype=Object.create(y),e},s.awrap=function(e){return{__await:e}},x(j.prototype),j.prototype[c]=function(){return this},s.AsyncIterator=j,s.async=function(e,t,n,r){var a=new j(g(e,t,n,r));return s.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(y),y[u]="Generator",y[i]=function(){return this},y.toString=function(){return"[object Generator]"},s.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},s.values=P,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,a){return c.type="throw",c.arg=e,t.next=r,a&&(t.method="next",t.arg=n),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=a.call(i,"catchLoc"),s=a.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;S(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),m}}}function g(e,t,n,r){var a=t&&t.prototype instanceof E?t:E,o=Object.create(a.prototype),i=new O(r||[]);return o._invoke=function(e,t,n){var r=l;return function(a,o){if(r===p)throw new Error("Generator is already running");if(r===f){if("throw"===a)throw o;return T()}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var c=_(i,n);if(c){if(c===m)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===l)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var u=b(e,t,n);if("normal"===u.type){if(r=n.done?f:h,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=f,n.method="throw",n.arg=u.arg)}}}(e,n,i),o}function b(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function E(){}function k(){}function R(){}function x(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function j(e){function t(n,r,o,i){var c=b(e[n],e,r);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==typeof s&&a.call(s,"__await")?Promise.resolve(s.__await).then((function(e){t("next",e,o,i)}),(function(e){t("throw",e,o,i)})):Promise.resolve(s).then((function(e){u.value=e,o(u)}),i)}i(c.arg)}var n;this._invoke=function(e,r){function a(){return new Promise((function(n,a){t(e,r,n,a)}))}return n=n?n.then(a,a):a()}}function _(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,_(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var a=b(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,m;var o=a.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function P(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}return{next:T}}function T(){return{value:n,done:!0}}}(function(){return this}()||Function("return this")())},942:(e,t,n)=>{e.exports=n(548)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e,t,r=n(942),a=n.n(r),o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&c.return&&c.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function h(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,n){return function r(a,o){try{var i=t[a](o),c=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(c).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(c)}("next")}))}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}e=function(){function e(){p(this,e)}var t;return i(e,[{key:"openProj",value:(t=h(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("./projects/"+t+"/state.json",{},"GET","xhr").then((function(e){if(e.ok)return e.json();throw console.error("打开文件失败\n请尝试创建文件"),"open file failed"})).then((function(e){return window.project=e,e})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"createProj",value:function(e,t,n,r){return new Promise((function(a,o){!e||!r||t<=0||n<=0?o("invalid input value"):fetch("./execute",{method:"POST",body:'{"method": "readProj", "arguments": {"projName": "'+e+'", "size": ['+8*Math.ceil(t/8)+", "+8*Math.ceil(n/8)+'], "J": '+r+"}}"}).then((function(e){return e.ok?e.json():{}})).then((function(e){return window.project=e,e})).then(a).catch(console.error)}))}},{key:"drawStateMap",value:function(e,t,n,r,a){var o=[],i={xAxis:{data:n.concat(r)},yAxis:{data:e.concat(t)},dataset:{source:o}};return i.xAxis.data.sort((function(e,t){return e-t})),i.yAxis.data.sort((function(e,t){return e-t})),t.forEach((function(e){return r.forEach((function(t){return o.push([String(e),String(t),1,"已完成"])}))})),""!==a&&o.push([].concat(l(a.map(String)),[2,"正在计算"])),i}},{key:"addTask",value:function(e,t){function n(e){if(-1!==e.indexOf(":")){for(var t=e.split(":").map(Number).map((function(e){return 1e6*e})),n=o(t,3),r=n[0],a=n[1],i=n[2],c=[];r<=i;)c.push(r/1e6),r+=a;return c}return-1!==e.indexOf(" ")?e.split(" ").map(Number):0===e.length?[]:[Number(e)]}return new Promise((function(r,a){e=n(e),t=n(t),e.map((function(e){return isNaN(e)})).reduce((function(e,t){return e||t}),!1)||t.map((function(e){return isNaN(e)})).reduce((function(e,t){return e||t}),!1)?a("输入的不是数字"):window.project.projName.length?fetch("./execute",{method:"POST",body:'{"method": "addQueue", "arguments": {"projName": "'+window.project.projName+'", "kT": ['+e.join(", ")+'], "uB": ['+t.join(", ")+"]}}"}).then((function(e){return e.text()})).then(r).catch((function(e){console.error(e),a(e)})):a("还没有打开了的项目，先打开一个")}))}},{key:"runTask",value:function(e,t,n,r,a){return new Promise((function(o,i){e&&t&&n?window.project.projName.length?fetch("./execute",{method:"POST",body:'{"method": "runProj", "arguments": {"projName": "'+window.project.projName+'", "step": '+e+', "count": '+t+', "accuracy": '+n+', "algorithm": "'+r+'", "savemode": '+a+"}}"}).then((function(e){return e.text()})).then(o).catch((function(e){console.error(e),i(e)})):i("还没有打开了的项目，先打开一个"):i("必要参数不全")}))}}]),e}(),t=function(){function e(){p(this,e),this.source=null,this.config=new Map([["e",["单粒子内能",3,7,0,0]],["m",["单粒子磁化强度",4,-1,0,1]],["c",["单粒子热容",5,8,0,0]],["s",["单粒子熵",6,9,2,2]],["ee",["能量平方",10,-1,0,0]],["em",["能量与广义力之积",11,12,-1,-1]]]),this.setData=this.setData.bind(this)}return i(e,[{key:"setData",value:function(e){var t=window.project.size[0]*window.project.size[1],n=window.project.kT_done.length;e.pop(),e.sort((function(e,t){return e[1]-t[1]||e[0]-t[0]})),e.forEach((function(e,r,a){a[r][10]=a[r][5],a[r][11]=a[r][6],a[r][5]=Number(((e[5]-Math.pow(e[3],2)*t)/Math.pow(e[0],2)).toFixed(4)),a[r][9]=Number(function(e,r){var a=e[r],o=r%n?e[r-1]:[0,a[1],0,0,0,0,0],i=(o[9]||0)+(o[5]/(o[0]||1)+a[5]/a[0])/2*(a[0]-o[0]);if(r<n)return i;var c=e[r-n];return(c[9]+(a[6]+c[6]-t*(a[3]*a[4]+c[3]*c[4]))/(2*Math.pow(a[0],2))*(a[1]-c[1])+i)/2}(a,r).toFixed(4))})),e.forEach((function(e,t,n){return n[t][6]=e[9]})),this.source=e}},{key:"getData",value:function(e,t){var n=this.config.get(t),r=o(n,5),a=r[0],i=r[1],c=r[2],u=r[3],l=r[4];if(e="heatmap"===e,u===l){var h=Math.pow(10,l);l=u=this.source[0][i],this.source.forEach((function(e){l=e[i]>l?e[i]:l,u=e[i]<u?e[i]:u})),l=Math.ceil(l*h)/h,u=Math.floor(u*h)/h}var p,f={dataset:{source:this.source},series:{encode:{value:a,tooltip:[0,1,a,2]}}};return e?f.visualMap=(s(p={min:u,max:l},"max",l),s(p,"dimension",a),p):(f.zAxis3D={name:a},c>=0&&(this.source.forEach((function(e,t,n){n[t][c]=(1e6*e[i]-1e6*u)/1e6})),a=c,f.zAxis3D.axisLabel={formatter:function(e){return function(t){return(1e6*t+1e6*e)/1e6}}(u)}),f.series.encode.z=a),f}}]),e}(),window.Utils=new e,window.Dataset=t,window.Method={};var f,m,d=function(e){function t(){return p(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,React.Component),i(t,[{key:"render",value:function(){return React.createElement("div",{id:"Nav",className:"shadow"},React.createElement("img",{id:"logoMobile",src:"img/menu.svg"}),React.createElement("img",{id:"logo",src:"img/logo.png"}),window.menu.map((function(e){return React.createElement("a",{className:"Nav",key:e.text,onClick:e.click},React.createElement("img",{className:"Nav",src:e.img}),e.text)})))}}]),t}(),v=function(e){function t(e){p(this,t);var n=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={display:n.props.defaultVal},n.hide=n.hide.bind(n),window.Method.Popups=n.show.bind(n),n}return u(t,React.Component),i(t,[{key:"hide",value:function(e){"Popups"===e.target.id&&this.setState({display:null})}},{key:"show",value:function(e){this.setState({display:e})}},{key:"componentWillUnmount",value:function(){window.Method.Popups=null}},{key:"render",value:function(){var e=this;return null!==this.state.display&&React.createElement("div",{id:"Popups",onClick:function(t){return e.hide(t)}},React.createElement("div",{className:"PopupsContain shadow"},this.props.value.get(this.state.display)))}}]),t}(),w=function(e){function t(e){p(this,t);var n=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={display:n.props.defaultVal},window.Method.Wins=n.show.bind(n),n}return u(t,React.Component),i(t,[{key:"show",value:function(e){this.setState({display:e})}},{key:"componentWillUnmount",value:function(){window.Method.Wins=null}},{key:"render",value:function(){return React.createElement("div",{id:"Wins"},this.props.value.get(this.state.display))}}]),t}(),y=function(e){function t(e){p(this,t);var n=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={wins:window.wins},n}return u(t,React.Component),i(t,[{key:"render",value:function(){var e=this,t=[],n=window.wins.keys(),r=void 0;for(n.next(),n.next();r=n.next().value;)t.push(React.createElement(g,{key:r,label:r},React.createElement("button",{"data-key":r,className:"imgBtn shadow",onClick:function(t){window.wins.delete(t.target.getAttribute("data-key")),e.setState({wins:window.wins})},style:{backgroundColor:"#f44336"}},React.createElement("img",{"data-key":r,className:"imgBtn",src:"img/trashBin_white.svg"})),React.createElement("button",{"data-key":r,className:"imgBtn shadow",onClick:function(e){window.Method.Wins(e.target.getAttribute("data-key")),window.Method.Popups(null)},style:{backgroundColor:window.Theme}},React.createElement("img",{"data-key":r,className:"imgBtn",src:"img/view_white.svg"}))));return React.createElement("ul",null,React.createElement("li",{style:{fontWeight:"bold",margin:"0.1rem 0.5rem"}},"更多窗口列表"),t.length?t:React.createElement(g,{label:"没有已绘制的图表可用"}))}}]),t}(),g=function(e){function t(){return p(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,React.Component),i(t,[{key:"render",value:function(){return React.createElement("li",{className:"list"},this.props.label,React.createElement("div",{className:"listValue"},this.props.children))}}]),t}(),b=function(e){function t(e){p(this,t);var n=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={kT:"",uB:"",step:window.project.size[0]*window.project.size[1]*10,count:5,accuracy:.01,algorithm:"SSFD",savemode:"false"},n.addTask=n.addTask.bind(n),n.runTask=n.runTask.bind(n),n}return u(t,React.Component),i(t,[{key:"addTask",value:function(){window.Utils.addTask(this.state.kT.replaceAll("：",":"),this.state.uB.replaceAll("：",":")).then(console.log).then(window.Method.refresh)}},{key:"runTask",value:function(){window.Utils.runTask(this.state.step,this.state.count,this.state.accuracy,this.state.algorithm,this.state.savemode).then(console.log).then(window.Method.refresh)}},{key:"render",value:function(){var e=this,t=[{lab:"kT",val:React.createElement("input",{className:"pure",type:"text",value:this.state.kT,onChange:function(t){e.setState({kT:t.target.value})}})},{lab:"μB",val:React.createElement("input",{className:"pure",type:"text",value:this.state.uB,onChange:function(t){e.setState({uB:t.target.value})}})}],n=[{lab:"取样步长",val:React.createElement("input",{className:"pure",value:this.state.step,onChange:function(t){e.setState({step:t.target.value})},type:"number",step:"1",min:"1"})},{lab:"取样步数",val:React.createElement("input",{className:"pure",value:this.state.count,onChange:function(t){e.setState({count:t.target.value})},type:"number",step:"1",min:"1"})},{lab:"收敛精度",val:React.createElement("input",{className:"pure",value:this.state.accuracy,onChange:function(t){e.setState({accuracy:t.target.value})},type:"number",step:"0.001",min:"0"})},{lab:"MCMC算法",val:React.createElement("select",{className:"pure",value:this.state.algorithm,onChange:function(t){e.setState({algorithm:t.target.value})}},React.createElement("option",{value:"SSFD"},"单自旋翻转动力学(Single-Spin-Flip Dynamics)"),React.createElement("option",{value:"CFD"},"集群翻转动力学(Cluster-Flip Dynamics)"))},{lab:"节约储存",val:React.createElement("select",{className:"pure",value:this.state.savemode,onChange:function(t){e.setState({savemode:t.target.value})}},React.createElement("option",{value:"true"},"启用"),React.createElement("option",{value:"false"},"禁用"))}];return React.createElement("div",{id:"Tasks"},React.createElement("ul",null,React.createElement("li",{style:{fontWeight:"bold",margin:"0.1rem 0.5rem"}},"添加任务"),React.createElement("li",{style:{maxWidth:"20rem"}},React.createElement("p",null,"输入内容可以为：单个数字；多个空格隔开的数字；初值:步长:最大值。"),React.createElement("p",null,"如：1或1 2 3或1:0.2:2"),React.createElement("p",null,"其中1:0.2:2表示从1开始间隔0.2取值，最大值为2"),React.createElement("hr",null)),t.map((function(e,t){return React.createElement(g,{key:t,label:e.lab},e.val)})),React.createElement("li",null,React.createElement(x,{bg:"#F44336",value:"重置",click:function(){e.setState({kT:"",uB:""})}}),React.createElement(x,{R:!0,bg:window.Theme,value:"添加",click:this.addTask}))),React.createElement("div",{className:"hrPlus"}),React.createElement("ul",null,React.createElement("li",{style:{fontWeight:"bold",margin:"0.1rem 0.5rem"}},"执行任务"),n.map((function(e,t){return React.createElement(g,{key:t,label:e.lab},e.val)})),React.createElement("li",null,React.createElement(x,{bg:"#F44336",value:"重置",click:function(){e.setState({step:10240,count:5,accuracy:.01,algorithm:"SSFD",savemode:"false"})}}),React.createElement(x,{R:!0,bg:window.Theme,value:"立即执行",click:this.runTask}))))}}]),t}(),E=function(e){function t(){return p(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,React.Component),i(t,[{key:"componentDidMount",value:function(){this.chart=echarts.init(this.el),this.chart.setOption(this.props.defaultVal),this.chart.setOption(this.props.data)}},{key:"componentWillUnmount",value:function(){this.chart.dispose()}},{key:"render",value:function(){var e=this;return React.createElement("div",{ref:function(t){return e.el=t},className:"Graphics"})}}]),t}(),k=function(e){function t(e){p(this,t);var n=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.draw=n.draw.bind(n),n}var n;return u(t,React.Component),i(t,[{key:"draw",value:(n=h(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),window.project.projName.length){e.next=3;break}return e.abrupt("return");case 3:return n=new window.Dataset,e.next=6,fetch("./projects/"+window.project.projName+"/statistics.csv",{},"GET","xhr").then((function(e){return e.text()})).then((function(e){if(e.length)return e;throw"Empty Response"})).then((function(e){return e.split("\n").map((function(e){return e.split(",").map(Number)}))})).then(n.setData).catch(console.error);case 6:window.dataset=n,new FormData(this.el).forEach((function(e,t){window.wins.set(window.project.projName+":"+e+"("+t+")",React.createElement(E,{key:window.project.projName+":"+e+"("+t+")",defaultVal:window[e+"Option"],data:n.getData(e,t)}))})),window.Method.Popups("more");case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"render",value:function(){var e=this;return React.createElement("form",{ref:function(t){return e.el=t}},React.createElement("ul",null,React.createElement("li",{style:{fontWeight:"bold",margin:"0.1rem 0.5rem"}},"图表绘制"),[{lab:"单粒子内能",val:"e"},{lab:"单粒子磁化强度",val:"m"},{lab:"单粒子熵增",val:"s"},{lab:"单粒子定磁场热容",val:"c"},{lab:"E^2/N",val:"ee"},{lab:"EM/N",val:"em"}].map((function(e,t){return React.createElement(g,{key:t,label:e.lab},React.createElement("label",null,React.createElement("input",{type:"checkbox",name:e.val,value:"heatmap"}),"热力图"),React.createElement("label",null,React.createElement("input",{type:"checkbox",name:e.val,value:"bar3D"}),"3D柱状图"))})),React.createElement("li",null,React.createElement("button",{style:{background:"#f44336"},className:"Btn shadow",type:"reset"},"重置"),React.createElement(x,{R:!0,bg:window.Theme,value:"绘制",click:this.draw}))))}}]),t}(),R=function(e){function t(e){p(this,t);var n=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={list:[]},n.preview=n.preview.bind(n),n.add=n.add.bind(n),n.merge=n.merge.bind(n),n}var n,r;return u(t,React.Component),i(t,[{key:"preview",value:(r=h(a().mark((function e(t){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.target.value){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,fetch("./projects/"+t.target.value+"/state.json",{},"GET","xhr").then((function(e){return e.json()}));case 4:n=e.sent,r=[["kT","uB","value","状态"]],n.kT_done.map(String).forEach((function(e){return n.uB_done.map(String).forEach((function(t){return r.push([e,t,1,"已完成"])}))})),this.chart1.setOption({xAxis:{data:n.uB_done.map(String)},yAxis:{data:n.kT_done.map(String)},dataset:{source:r}});case 8:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"add",value:(n=h(a().mark((function e(t){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.el3.value){e.next=3;break}return e.abrupt("return");case 3:return this.setState({list:this.state.list.concat([t])}),n=this.chart2._data_,e.next=7,fetch("./projects/"+t+"/state.json",{},"GET","xhr").then((function(e){return e.json()}));case 7:(r=e.sent).kT_done.map(String).forEach((function(e){return r.uB_done.map(String).forEach((function(t){return n.push([e,t,1,"已完成"])}))})),n.sort((function(e,t){return e[1]-t[1]||e[0]-t[0]})),this.chart2.setOption({dataset:{source:n}});case 11:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"merge",value:function(e){(e=this.el4.value)&&this.state.list.length&&fetch("./execute",{method:"POST",body:'{"method": "mergeProj", "arguments": {"source": ["'+this.state.list.join('","')+'"], "target": "'+e+'"}}'}).then((function(e){return e.ok?e.json():{}})).then((function(e){return window.project=e,e})).catch(console.error)}},{key:"componentDidMount",value:function(){this.chart1=window.echarts.init(this.el1),this.chart2=window.echarts.init(this.el2),this.chart1.setOption(window.StateMapOption),this.chart2.setOption(window.StateMapOption),this.chart2._data_=[]}},{key:"componentWillUnmount",value:function(){this.chart1.dispose(),this.chart2.dispose()}},{key:"render",value:function(){var e=this;return React.createElement("div",{id:"MergeArea"},React.createElement("div",{style:{width:"40vw",textAlign:"center"}},"预览项目：",React.createElement("select",{className:"pure",onChange:this.preview},React.createElement("option",null),window.projectList.map((function(e,t){return React.createElement("option",{key:t},e)})))),React.createElement("div",{style:{width:"40vw"}},"源文件：",this.state.list.map((function(e,t){return React.createElement("div",{className:"inline",key:t},e)})),React.createElement("br",null),"添加文件",React.createElement("input",{className:"pure",ref:function(t){return e.el3=t}}),React.createElement(x,{R:"R",bg:window.Theme,value:"添加",click:this.add}),React.createElement("br",null),"输出文件",React.createElement("input",{className:"pure",ref:function(t){return e.el4=t}}),React.createElement(x,{R:"R",bg:window.Theme,value:"合并",click:this.merge})),React.createElement("div",{id:"mergePre",ref:function(t){return e.el1=t}}),React.createElement("div",{id:"StateMap",ref:function(t){return e.el2=t}}))}}]),t}(),x=function(e){function t(){return p(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,React.Component),i(t,[{key:"render",value:function(){return React.createElement("button",{style:{background:this.props.bg},className:"Btn shadow"+(this.props.R?" BtnR":""),onClick:this.props.click},this.props.value)}}]),t}(),j=function(e){function t(){return p(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,React.Component),i(t,[{key:"componentDidMount",value:function(){var e;this.chart=window.echarts.init(this.el),this.chart.setOption(window.StateMapOption),this.chart.setOption((e=window.Utils).drawStateMap.apply(e,l(this.props.value)))}},{key:"componentWillUnmount",value:function(){this.chart.dispose()}},{key:"componentDidUpdate",value:function(e){var t;this.props.value.map((function(t,n){return e.value[n]===t})).reduce((function(e,t){return e&&t}),!0)||this.chart.setOption((t=window.Utils).drawStateMap.apply(t,l(this.props.value)))}},{key:"render",value:function(){var e=this;return React.createElement("div",null,React.createElement("div",{id:"StateMap",ref:function(t){return e.el=t}}))}}]),t}(),_=function(e){function t(e){p(this,t);var n=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state=window.project,n.state.mode="view",n.state.formProjName="Untitled",n.state.formSize1=8,n.state.formSize2=8,n.state.formJ=1,n.openProj=n.openProj.bind(n),n.createProj=n.createProj.bind(n),window.Method.refresh=n.refresh=n.refresh.bind(n),n}return u(t,React.Component),i(t,[{key:"openProj",value:function(){var e=this;window.Utils.openProj(this.state.formProjName).then((function(t){e.setState(t),e.setState({mode:"view"})}))}},{key:"createProj",value:function(){var e=this;window.Utils.createProj(this.state.formProjName,this.state.formSize1,this.state.formSize2,this.state.formJ).then((function(t){e.setState(t),e.setState({mode:"view"})}))}},{key:"auto",value:function(e){var t=e.value;window.clearInterval(this.timer),(t=Number(t))>0&&(this.timer=window.setInterval(this.refresh,t)),-2===t&&(this.refresh(),e.value="-1")}},{key:"refresh",value:function(){var e=this;window.Utils.openProj(this.state.projName).then((function(t){return e.setState(t)}))}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.timer)}},{key:"render",value:function(){var e=this,t={list:[["项目名: ",React.createElement("input",{className:"pure",value:this.state.formProjName,onChange:function(t){return e.setState({formProjName:t.target.value})}})],["模型尺寸: ",this.state.size.join("x")],["相互作用能 J: ",this.state.J]],btn:[["取消",function(){e.setState({mode:"view"})},"#f44336"]]};switch(this.state.mode){case"view":t.title="项目状态",t.list[0][1]=this.state.projName||"——",t.list.push(["模型ID: ",this.state.ID.join(" , ")]),this.state.projName.length>0&&t.list.push(["自动刷新: ",React.createElement("select",{className:"pure",defaultValue:"-1",onChange:function(t){return e.auto(t.target)}},React.createElement("option",{value:"-1"},"关"),React.createElement("option",{value:"-2"},"立即刷新"),React.createElement("option",{value:"10000"},"10s"),React.createElement("option",{value:"5000"},"5s"),React.createElement("option",{value:"3000"},"3s"))]),t.btn=[["创建项目",function(){e.setState({mode:"create"})},window.Theme],["打开项目",function(){e.setState({mode:"open"})},window.Theme]];break;case"open":t.title="打开项目",t.list=[t.list[0]],t.btn.push(["确定",this.openProj,window.Theme]);break;case"create":t.title="创建项目",t.list[1][1]=[React.createElement("input",{className:"pure",value:this.state.formSize1,type:"number",step:"8",min:"8",key:"0",onChange:function(t){e.setState({formSize1:Number(t.target.value)})}}),"x",React.createElement("input",{className:"pure",value:this.state.formSize2,type:"number",step:"8",min:"8",key:"1",onChange:function(t){return e.setState({formSize2:Number(t.target.value)})}})],t.list[2][1]=React.createElement("input",{className:"pure",value:this.state.formJ,type:"number",onChange:function(t){return e.setState({formJ:Number(t.target.value)})}}),t.btn.push(["确定",this.createProj,window.Theme])}return React.createElement("div",{id:"Project"},React.createElement("ul",{className:"shadow"},React.createElement("li",{style:{fontWeight:"bold",margin:"0.1rem 0.5rem"}},t.title),t.list.map((function(e,t){return React.createElement(g,{key:t,label:e[0]},e[1])})),React.createElement("li",{style:{textAlign:"center"}},t.btn.map((function(e,t){return React.createElement(x,{R:1===t,key:t,bg:e[2],click:e[1],value:e[0]})})))),React.createElement(j,{value:[this.state.kT,this.state.kT_done,this.state.uB,this.state.uB_done,this.state.doing]}))}}]),t}(),N=function(e){function t(){return p(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,React.Component),i(t,[{key:"render",value:function(){return React.createElement("div",{id:"App"},React.createElement(d,null),React.createElement(w,{defaultVal:"project",value:window.wins}),React.createElement(v,{defaultVal:null,value:window.popups}))}}]),t}(),S=void 0;function O(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,n){return function r(a,o){try{var i=t[a](o),c=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(c).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(c)}("next")}))}}window.Theme="#4CAF50",window.project={projName:"",size:[0,0],J:"——",kT:[1,1.5,2,2.5],kT_done:[],uB:[0,1,2,3,4],uB_done:[],doing:"",ID:["——","——"]},window.projectList=[],window.menu=[{text:"项目状态",img:"./img/file_white.svg",click:function(){window.Method.Wins("project")}},{text:"计算任务",img:"./img/browser.svg",click:function(){window.Method.Popups("task")}},{text:"图表绘制",img:"./img/graph.svg",click:function(){window.Method.Popups("draw")}},{text:"任务合并",img:"./img/merge.svg",click:(m=O(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./execute",{method:"POST",body:'{"method": "listAll", "arguments": {}}'}).then((function(e){return e.text()})).then((function(e){return e.replace("\r\n","").split(",")})).catch((function(){return[]}));case 2:window.projectList=e.sent,window.Method.Wins("merge");case 4:case"end":return e.stop()}}),e,S)}))),function(){return m.apply(this,arguments)})},{text:"更多窗口",img:"./img/more_white.svg",click:(f=O(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.Method.Popups("more");case 1:case"end":return e.stop()}}),e,S)}))),function(){return f.apply(this,arguments)})}],window.wins=new Map([["project",React.createElement(_,null)],["merge",React.createElement(R,null)]]),window.popups=new Map([["task",React.createElement(b,null)],["draw",React.createElement(k,null)],["more",React.createElement(y,null)]]);var P=["kT","uB","取样成功率","单粒子内能","单粒子磁化强度","单粒子热容","单粒子熵","偏移单粒子内能","偏移单粒子热容","偏移单粒子熵","能量平方","能量与广义力之积","偏移EM积"];window.StateMapOption={grid:{right:100,top:65,bottom:65},xAxis:{type:"category",name:"μB (J)"},yAxis:{type:"category",name:"kT (J)"},visualMap:{type:"piecewise",left:"right",top:"center",categories:["正在计算","已完成"],color:[window.Theme,"#E91E63"]},tooltip:{formatter:function(e){return[0,1,3].map((function(t){return[e.dimensionNames[t],e.data[t]]})).map((function(t){return""+e.marker+t[0]+':<strong style="margin-left:1rem;">'+t[1]+"</strong><br>"})).join("")}},series:[{name:"",dimensions:["kT","uB","value","状态"],type:"heatmap",encode:{x:"uB",y:"kT"},emphasis:{itemStyle:{borderColor:"#333",borderWidth:1}},progressive:1e3,animation:!1}]};var T=function(e){return[0,1,(e.encode.value||e.encode.z)[0],2].map((function(t){return""+e.marker+P[t]+':<strong style="margin-left:1rem;">'+e.data[t]+"</strong><br>"})).join("")};window.heatmapOption={dataset:{sourceHeader:!1,dimensions:P,source:[]},grid:{left:"20%",right:"10%",top:"10%",bottom:"20%"},tooltip:{formatter:T},xAxis:{type:"category",name:"μB (J)"},yAxis:{type:"category",name:"kT (J)"},visualMap:{type:"continuous",precision:1,calculable:!0,realtime:!1,inRange:{color:["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffbf","#fee090","#fdae61","#f46d43","#d73027","#a50026"]}},series:{type:"heatmap",encode:{x:"uB",y:"kT"},name:"",progressive:1e3}},window.bar3DOption={dataset:{sourceHeader:!1,dimensions:P,source:[]},backgroundColor:"#100C2A",tooltip:{position:["2.8%","5%"],formatter:T},grid3D:{axisLine:{lineStyle:{color:"#fff"}},axisPointer:{lineStyle:{color:"#fff"}},light:{main:{shadow:!0,quality:"medium",intensity:1,alpha:60,beta:135}}},xAxis3D:{type:"category",name:"μB (J)"},yAxis3D:{type:"category",name:"kT (J)"},zAxis3D:{type:"value"},visualMap:{dimension:2,precision:2,min:0,max:1,textStyle:{color:"#ffffff"},color:[window.Theme,"#F44336"]},series:{type:"bar3D",encode:{x:"uB",y:"kT"},shading:"lambert",name:"",progressive:1e3}},ReactDOM.render(React.createElement(React.StrictMode,null,React.createElement(N,null)),document.getElementById("root")),window.onload=function(){var e=document.createElement("span");e.style.cssText="position:absolute;z-index:-1;visibility:hidden;top:0;left:0;",e.innerHTML="<img src='img/trashBin_white.svg'><img src='img/view_white.svg'>",document.body.appendChild(e)}})()})();